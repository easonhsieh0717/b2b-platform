# 測試指南

## 系統狀態

目前系統已完成約 **80%** 的核心功能，可以進行完整流程測試。

## 啟動系統

### 1. 啟動後端

```bash
cd backend
npm install
npx prisma generate
npx prisma migrate dev --name init
npm run dev
```

後端將運行在 http://localhost:3000

### 2. 啟動前端

```bash
cd frontend
npm install
npm run dev
```

前端將運行在 http://localhost:5173

## 測試流程

### 步驟 1：註冊兩個帳號（買家和賣家）

#### 賣家帳號 1
1. 訪問 http://localhost:5173
2. 點擊「登入」
3. 選擇「LINE 登入」
4. 輸入 LINE ID：`seller001`
5. 點擊「登入」
6. 填寫註冊資訊：
   - 統編：`12345678`
   - 公司名稱：`測試通訊行`
   - 分店代碼：`001`
   - 分店名稱：`總店`
   - 地址：`台北市信義區信義路五段7號`
   - 城市：`台北市`
   - 區域：`信義區`
   - 姓名：`王老闆`
7. 點擊「完成註冊」

#### 買家帳號 2
1. 登出或使用無痕視窗
2. 選擇「Google 登入」
3. 輸入 Email：`buyer@test.com`
4. 輸入 Google ID：`buyer001`
5. 點擊「登入」
6. 填寫註冊資訊：
   - 統編：`87654321`
   - 公司名稱：`測試維修店`
   - 分店代碼：`001`
   - 分店名稱：`總店`
   - 地址：`新北市板橋區文化路一段188巷`
   - 城市：`新北市`
   - 區域：`板橋區`
   - 姓名：`李老闆`
7. 點擊「完成註冊」

### 步驟 2：賣家上架商品

1. 使用賣家帳號登入
2. 點擊「我的庫存」
3. 點擊「新增商品」
4. 填寫商品資訊：
   - 品牌：`Apple`
   - 型號：`iPhone 15 Pro`
   - 規格：`256GB`
   - 顏色：`藍色鈦金屬`
   - 容量：`256GB`
   - 等級：`全新`
   - 數量：`5`
   - 價格：`35000`
   - 勾選「需要 IMEI/序號」
5. 點擊「儲存」

### 步驟 3：買家找貨並下單

1. 使用買家帳號登入（或登出後直接瀏覽）
2. 點擊「找貨」
3. 在搜尋欄輸入 `iPhone` 或直接瀏覽
4. 點擊商品卡片進入詳情頁
5. 點擊「立即下單」
6. 填寫數量：`1`
7. 點擊「建立訂單」

### 步驟 4：訂單流程

#### 4.1 賣家確認訂單
1. 使用賣家帳號登入
2. 點擊「訂單」
3. 點擊訂單進入詳情頁
4. 點擊「確認訂單」

#### 4.2 買家付款
1. 使用買家帳號登入
2. 點擊「訂單」
3. 點擊訂單進入詳情頁
4. 點擊「付款（虛擬帳號/ATM）」
5. 在彈出視窗點擊「確定」模擬付款完成

#### 4.3 賣家取得物流報價並派車
1. 使用賣家帳號
2. 在訂單詳情頁點擊「取得物流報價」
3. 點擊「派車」

#### 4.4 買家驗收
1. 使用買家帳號
2. 在訂單詳情頁點擊「驗收完成」

## 測試重點

### ✅ 已實現功能
- [x] 註冊與登入（模擬）
- [x] 統編綁定
- [x] 庫存上架
- [x] 商品搜尋
- [x] 下單流程
- [x] 訂單確認
- [x] 付款流程（模擬）
- [x] 物流報價與派車（模擬）
- [x] 驗收功能

### ⏳ 待完成功能
- [ ] 實際 LINE OAuth 整合
- [ ] 實際 Google OAuth 整合
- [ ] LINE Bot 通知
- [ ] CSV 匯入庫存
- [ ] 議價聊天室
- [ ] 實際 Lalamove API 整合
- [ ] 實際第三方金流整合
- [ ] 對帳/開票功能
- [ ] IMEI/序號掃碼上傳

## 注意事項

1. **模擬功能**：目前 LINE/Google 登入、付款、物流都是模擬功能，用於測試流程
2. **資料庫**：使用 SQLite，資料存在 `backend/dev.db`
3. **環境變數**：確保 `backend/.env` 已設置 JWT_SECRET
4. **CORS**：前端運行在 5173 端口，後端在 3000 端口

## 問題排查

### 後端無法啟動
- 檢查 Node.js 版本（需要 18+）
- 確認已執行 `npx prisma generate` 和 `npx prisma migrate dev`
- 檢查端口 3000 是否被占用

### 前端無法連接後端
- 確認後端已啟動
- 檢查 `frontend/vite.config.ts` 中的 proxy 設定
- 確認 CORS_ORIGIN 環境變數

### 資料庫錯誤
- 刪除 `backend/dev.db` 重新執行 migration
- 檢查 `DATABASE_URL` 環境變數

## 下一步

當您完成測試後，我們可以：
1. 整合實際的 LINE OAuth
2. 整合實際的 Lalamove API
3. 整合實際的第三方金流
4. 實作 LINE Bot 通知
5. 完善其他功能
